apiVersion: admissionregistration.k8s.io/v1beta1
kind: ValidatingWebhookConfiguration
metadata:
  name: istiod-istio-system-mcp
  labels:
    app: istiod
    release: istio
    istio: istiod
webhooks:
- name: validation.istio.io
  clientConfig:
    url: VALIDATION_URL # {"$ref":"#/definitions/io.k8s.cli.substitutions.validation-url"}
    caBundle: "" # patched at runtime when the webhook is ready.
  rules:
  - operations:
    - CREATE
    - UPDATE
    apiGroups:
    - security.istio.io
    - networking.istio.io
    apiVersions:
    - "*"
    resources:
    - "*"
  # Fail open until the validation webhook is ready. The webhook controller
  # will update this to `Fail` and patch in the `caBundle` when the webhook
  # endpoint is ready.
  failurePolicy: Ignore
  sideEffects: None
  admissionReviewVersions: ["v1beta1", "v1"]
